{"version":3,"sources":["../../../src/utils/tracer/index.js"],"names":["slash","require","path","opentracing","tracerProvider","initTracer","tracerFile","tracer","resolvedPath","resolve","create","Tracer","initGlobalTracer","stopTracer","stop","module","exports"],"mappings":";;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAE,OAAF,CAArB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAE,MAAF,CAApB;;AACA,MAAME,WAAW,GAAGF,OAAO,CAAE,aAAF,CAA3B;;AAEA,IAAIG,cAAJ;AAEA;;;;;;;;;;AASA,SAASC,UAAT,CAAoBC,UAApB,EAAgC;AAC9B,MAAIC,MAAJ;;AACA,MAAID,UAAJ,EAAgB;AACd,UAAME,YAAY,GAAGR,KAAK,CAACE,IAAI,CAACO,OAAL,CAAaH,UAAb,CAAD,CAA1B;AACAF,IAAAA,cAAc,GAAGH,OAAO,CAACO,YAAD,CAAxB;AACAD,IAAAA,MAAM,GAAGH,cAAc,CAACM,MAAf,EAAT;AACD,GAJD,MAIO;AACLH,IAAAA,MAAM,GAAG,IAAIJ,WAAW,CAACQ,MAAhB,EAAT,CADK,CAC6B;AACnC;;AAEDR,EAAAA,WAAW,CAACS,gBAAZ,CAA6BL,MAA7B;AAEA,SAAOA,MAAP;AACD;;AAED,eAAeM,UAAf,GAA4B;AAC1B,MAAIT,cAAc,IAAIA,cAAc,CAACU,IAArC,EAA2C;AACzC,UAAMV,cAAc,CAACU,IAAf,EAAN;AACD;AACF;;AAEDC,MAAM,CAACC,OAAP,GAAiB;AACfX,EAAAA,UADe;AAEfQ,EAAAA;AAFe,CAAjB","sourcesContent":["const slash = require(`slash`)\nconst path = require(`path`)\nconst opentracing = require(`opentracing`)\n\nlet tracerProvider\n\n/**\n * tracerFile should be a js file that exports two functions.\n *\n * `create` - Create and return an open-tracing compatible tracer. See\n * https://github.com/opentracing/opentracing-javascript/blob/master/src/tracer.ts\n *\n * `stop` - Run any tracer cleanup required before the node.js process\n * exits\n */\nfunction initTracer(tracerFile) {\n  let tracer\n  if (tracerFile) {\n    const resolvedPath = slash(path.resolve(tracerFile))\n    tracerProvider = require(resolvedPath)\n    tracer = tracerProvider.create()\n  } else {\n    tracer = new opentracing.Tracer() // Noop\n  }\n\n  opentracing.initGlobalTracer(tracer)\n\n  return tracer\n}\n\nasync function stopTracer() {\n  if (tracerProvider && tracerProvider.stop) {\n    await tracerProvider.stop()\n  }\n}\n\nmodule.exports = {\n  initTracer,\n  stopTracer,\n}\n"],"file":"index.js"}